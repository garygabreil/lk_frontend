<!-- delete -->
<!-- modal dialog to delete patient -->
<div
  class="modal fade"
  id="deleteModal"
  tabindex="-1"
  aria-labelledby="deleteModal"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1
          class="modal-title fs-5 fw-lighter text-capitalize"
          id="deleteModal"
        >
          Delete Invoice
        </h1>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
          (click)="deleteSessionByID()"
        ></button>
      </div>
      <div class="modal-body fw-lighter">
        Are you sure, you want to delete the invoice entry?
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-danger btn-sm fw-lighter text-capitalize"
          (click)="deleteInvoice()"
        >
          <span *ngIf="!showDeleteProgressBar">yes</span>
          <div
            class="spinner-border text-light"
            role="status"
            *ngIf="showDeleteProgressBar"
          >
            <span class="visually-hidden">Loading...</span>
          </div>
        </button>
        <button
          type="button"
          class="btn btn-sm btn-secondary fw-lighterm text-capitalize"
          data-bs-dismiss="modal"
          #closeModal
          (click)="deleteSessionByID()"
        >
          no
        </button>
      </div>
    </div>
  </div>
</div>

<!-- report -->
<div class="accordion" id="accordionExample" style="margin-left: 25%">
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingOne">
      <button
        class="accordion-button fw-lighter"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#collapseOne"
        aria-expanded="true"
        aria-controls="collapseOne"
      >
        Total Invoices Created Today : {{ totalNumberOfEntries }}
      </button>
    </h2>
    <div
      id="collapseOne"
      class="accordion-collapse collapse fw-lighter"
      aria-labelledby="headingOne"
      data-bs-parent="#accordionExample"
    >
      <div class="accordion-body fw-lighter">
        <!--  -->
        <div class="card" id="noshow">
          <br />
          <div class="container fw-lighter">
            <div class="row">
              <div class="col-3">
                <input
                  type="text"
                  class="form-control fw-lighter mb-2"
                  placeholder="Search..."
                  aria-label="search"
                  [(ngModel)]="search"
                />
              </div>
              <div class="col"></div>
            </div>

            <div class="fw-bolder text-capitalize">
              <u>Invoices</u> : {{ totalNumberOfEntries }}
            </div>
            <br />
            <!-- Table -->
            <table
              class="table table-bordered table-striped fw-lighter"
              *ngIf="invoiceData.length > 0; else no_data_content"
            >
              <thead class="thead-dark">
                <tr>
                  <th class="fw-lighter text-capitalize">#</th>
                  <th class="fw-lighter text-capitalize">Invoice ID</th>
                  <th class="fw-lighter text-capitalize">Created Date</th>
                  <th class="fw-lighter text-capitalize">Patient Name</th>
                  <th class="fw-lighter text-capitalize">Payment Type</th>
                  <th class="fw-lighter text-capitalize">Payment Status</th>
                  <th class="fw-lighter text-capitalize">view</th>
                  <th class="fw-lighter text-capitalize">delete</th>
                </tr>
              </thead>
              <tbody id="tableBody">
                <tr
                  *ngFor="
                    let medicine of invoiceData
                      | search : search
                      | paginate : { itemsPerPage: 10, currentPage: p };
                    let i = index
                  "
                >
                  <td class="fw-lighter text-capitalize">{{ i + 1 }}</td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.invoiceID }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.invoiceDate }}
                  </td>

                  <td class="fw-lighter text-capitalize">
                    {{ medicine.patientName }}
                  </td>

                  <td class="fw-lighter text-capitalize">
                    {{ medicine.paymentType }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.paymentStatus }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    <button
                      class="btn btn-sm btn-success text-capitalize fw-lighter"
                      data-bs-toggle="modal"
                      data-bs-target="#editModal"
                      (click)="viewInvoice(medicine._id)"
                    >
                      view
                    </button>
                  </td>
                  <td>
                    <button
                      class="btn btn-sm btn-danger text-capitalize fw-lighter"
                      data-bs-toggle="modal"
                      data-bs-target="#deleteModal"
                      (click)="deleteMedicineById(medicine._id)"
                    >
                      delete
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
            <ng-template #no_data_content class="fw-bolder"
              >No Invoices</ng-template
            >
            <pagination-controls
              (pageChange)="p = $event"
              *ngIf="invoiceData.length > 0"
            ></pagination-controls>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingTwo">
      <button
        class="accordion-button collapsed fw-lighter"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#collapseTwo"
        aria-expanded="false"
        aria-controls="collapseTwo"
      >
        Search by specific critiera
      </button>
    </h2>
    <div
      id="collapseTwo"
      class="accordion-collapse collapse"
      aria-labelledby="headingTwo"
      data-bs-parent="#accordionExample"
    >
      <div class="accordion-body fw-lighter">
        <form (ngSubmit)="searchInvoices()" [formGroup]="searchForm">
          <div class="container">
            <div class="row">
              <div class="col-4">
                <label for="paymentType">Payment Type</label>
                <select
                  id="paymentStatus"
                  class="form-control"
                  formControlName="paymentType"
                  name="paymentStatus"
                >
                  <option value="" disabled>Select Payment Status</option>
                  <option *ngFor="let status of paymentTypes" [value]="status">
                    {{ status }}
                  </option>
                </select>
              </div>
              <div class="col-4">
                <label for="paymentStatus">Payment Status</label>
                <select
                  id="paymentStatus"
                  class="form-control"
                  formControlName="paymentStatus"
                  name="paymentStatus"
                >
                  <option value="" disabled>Select Payment Status</option>
                  <option
                    *ngFor="let status of paymentStatuses"
                    [value]="status"
                  >
                    {{ status }}
                  </option>
                </select>
              </div>
              <div class="col-4">
                <label for="patientName">Patient Name</label>
                <input
                  type="text"
                  formControlName="patientName"
                  (keyup)="onSearchName($any($event.target).value)"
                  placeholder="Search for Patient"
                  class="form-control fw-lighter"
                  name="patientName"
                />
                <ul *ngIf="suggestionsName && suggestionsName.length > 0">
                  <option
                    *ngFor="let suggestionsName of suggestionsName"
                    (click)="onSelectPatientName(suggestionsName)"
                  >
                    {{ suggestionsName.patientName }},
                    {{ suggestionsName.patientAddress }}
                  </option>
                </ul>
                <button
                  type="button"
                  class="btn btn-link"
                  [routerLink]="['/create-patient']"
                  *ngIf="showCreateNewPatientLink"
                >
                  Patient not found, created it
                </button>
              </div>
            </div>
          </div>
          <br />

          <div class="col-4">
            <label for="invoiceDate">Invoice Date (MM-dd-yyyy)</label>
            <mat-form-field>
              <input
                matInput
                [matDatepicker]="picker"
                placeholder="Choose a date"
                name="date"
                formControlName="invoiceDate"
              />
              <mat-datepicker-toggle
                matSuffix
                [for]="picker"
              ></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>

            <button type="submit" class="btn btn-success">
              Search Invoices
            </button>

            <hr />
          </div>
        </form>

        <div class="card" id="noshow">
          <div class="container fw-lighter">
            <h5 class="mb-4 fw-bolder"></h5>
            <!-- Search input -->
            <div class="row">
              <div class="col-3">
                <input
                  type="text"
                  class="form-control fw-lighter mb-2"
                  placeholder="Search..."
                  aria-label="search"
                  [(ngModel)]="search"
                />
              </div>
              <div class="col"></div>
            </div>

            <div class="fw-bolder text-capitalize">
              <u>Invoices</u> : {{ totalNumberOfEntriesForSpecific }}
            </div>
            <br />
            <!-- Table -->
            <table
              class="table table-bordered table-striped fw-lighter"
              *ngIf="totalNumberOfEntriesForSpecific > 0; else no_data_content"
            >
              <thead class="thead-dark">
                <tr>
                  <th class="fw-lighter text-capitalize">#</th>
                  <th class="fw-lighter text-capitalize">Invoice ID</th>
                  <th class="fw-lighter text-capitalize">Created Date</th>
                  <th class="fw-lighter text-capitalize">Patient Name</th>
                  <th class="fw-lighter text-capitalize">Payment Type</th>
                  <th class="fw-lighter text-capitalize">Payment Status</th>
                  <th class="fw-lighter text-capitalize">view</th>
                  <th class="fw-lighter text-capitalize">delete</th>
                </tr>
              </thead>
              <tbody id="tableBody">
                <tr
                  *ngFor="
                    let medicine of groupedInvoicesBySpecificDate
                      | search : search
                      | paginate : { itemsPerPage: 10, currentPage: p };
                    let i = index
                  "
                >
                  <td class="fw-lighter text-capitalize">{{ i + 1 }}</td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.invoiceID }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.invoiceDate }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.patientName }}
                  </td>

                  <td class="fw-lighter text-capitalize">
                    {{ medicine.paymentType }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.paymentStatus }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    <button
                      class="btn btn-sm btn-success text-capitalize fw-lighter"
                      (click)="viewInvoice(medicine._id)"
                    >
                      view
                    </button>
                  </td>
                  <td>
                    <button
                      class="btn btn-sm btn-danger text-capitalize fw-lighter"
                      data-bs-toggle="modal"
                      data-bs-target="#deleteModal"
                      (click)="deleteMedicineById(medicine._id)"
                    >
                      delete
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
            <ng-template #no_data_content class="fw-bolder"
              >No Invoices</ng-template
            >
            <pagination-controls
              (pageChange)="p = $event"
              *ngIf="groupedInvoicesBySpecificDate.length > 0"
            ></pagination-controls>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingThree">
      <button
        class="accordion-button collapsed fw-lighter"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#collapseThree"
        aria-expanded="false"
        aria-controls="collapseThree"
      >
        All Invoices
      </button>
    </h2>
    <div
      id="collapseThree"
      class="accordion-collapse collapse"
      aria-labelledby="headingThree"
      data-bs-parent="#accordionExampleThree"
    >
      <div class="accordion-body fw-lighter">
        <div class="card" id="noshow">
          <div class="container fw-lighter">
            <h5 class="mb-4 fw-bolder"></h5>
            <!-- Search input -->
            <div class="row">
              <div class="col-3">
                <input
                  type="text"
                  class="form-control fw-lighter mb-2"
                  placeholder="Search..."
                  aria-label="search"
                  [(ngModel)]="search"
                />
              </div>
              <div class="col"></div>
            </div>

            <div class="fw-bolder text-capitalize">
              <u>Invoices</u> : {{ totalNumberOfEntriesAll }}
            </div>
            <br />
            <!-- Table -->
            <table
              class="table table-bordered table-striped fw-lighter"
              *ngIf="invoiceDataAll?.length > 0; else no_data_content"
            >
              <thead class="thead-dark">
                <tr>
                  <th class="fw-lighter text-capitalize">#</th>
                  <th class="fw-lighter text-capitalize">Invoice ID</th>
                  <th class="fw-lighter text-capitalize">Created Date</th>
                  <th class="fw-lighter text-capitalize">Patient Name</th>
                  <th class="fw-lighter text-capitalize">Payment Type</th>
                  <th class="fw-lighter text-capitalize">Payment Status</th>
                  <th class="fw-lighter text-capitalize">view</th>
                  <th class="fw-lighter text-capitalize">delete</th>
                </tr>
              </thead>
              <tbody id="tableBody">
                <tr
                  *ngFor="
                    let medicine of invoiceDataAll
                      | search : search
                      | paginate : { itemsPerPage: 10, currentPage: p };
                    let i = index
                  "
                >
                  <td class="fw-lighter text-capitalize">{{ i + 1 }}</td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.invoiceID }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.invoiceDate }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.patientName }}
                  </td>

                  <td class="fw-lighter text-capitalize">
                    {{ medicine.paymentType }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    {{ medicine.paymentStatus }}
                  </td>
                  <td class="fw-lighter text-capitalize">
                    <button
                      class="btn btn-sm btn-success text-capitalize fw-lighter"
                      (click)="viewInvoice(medicine._id)"
                    >
                      view
                    </button>
                  </td>
                  <td>
                    <button
                      class="btn btn-sm btn-danger text-capitalize fw-lighter"
                      data-bs-toggle="modal"
                      data-bs-target="#deleteModal"
                      (click)="deleteMedicineById(medicine._id)"
                    >
                      delete
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
            <ng-template #no_data_content class="fw-bolder"
              >No Invoices</ng-template
            >
            <pagination-controls
              (pageChange)="p = $event"
              *ngIf="groupedInvoicesBySpecificDate.length > 0"
            ></pagination-controls>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
